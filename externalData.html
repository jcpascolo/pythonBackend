<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <main>
        <h1>
            Simulate external data
        </h1>
    </main>
    <script>
        const socket = new WebSocket('ws://127.0.0.1:8000/security-price')

        socket.onmessage = function (e) {
            const data = JSON.parse(e.data);
            console.log(data);
        };

        socket.onclose = function (e) {
            console.error('Socket closed unexpectedly');
        };

        let i = 1;

        setInterval(() => {
            let message = {
                securityName: "SCR" + (i % 10),
                date: new Date(),
                price: parseFloat((i * 1.5).toFixed(2))
            }

            socket.send(JSON.stringify({
                'message': message,
            }))

            i += 1;

        }, 10000)
    </script>
</body>

</html>